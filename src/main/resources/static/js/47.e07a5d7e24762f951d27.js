webpackJsonp([47],{"+L4n":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Dd8w"),r=s.n(i),a=s("NYxO"),n=s("VsUZ");function l(t){return Object(n.a)({url:"/areas/listAreaByParent/"+t,method:"get",data:t})}var o=s("STSY"),u=s("PJh5"),d=s.n(u),c={data:function(){return{list:[],qxList:[],jdList:[],listLoading:!1,roles:[],listQuery:{},dialogStatus:"create",dialogFormVisible:!1,textMap:{update:"编辑",create:"新建用户"},tempUser:{uuid:"",username:"",password:"",nickname:"",roleUuids:[],qxid:"",jdid:""}}},created:function(){this.getList()},computed:r()({},Object(a.b)(["dict"]),{listQueryX:function(){var t=this.listQuery;return r()({},t,{pageNum:this.$store.getters.pageNum,pageRow:this.$store.getters.pageRow})},showList:function(){return this.$route.name.indexOf("List")>-1},query:function(){return this.getQuery(this.listQueryX)}}),watch:{"listQueryX.pageNum":"getList","listQueryX.pageRow":function(t,e){1===this.$store.getters.pageNum?this.getList():this.$store.dispatch("TogglePageNum",1)}},methods:{getUser:function(t){var e=this;(function(t){return Object(n.a)({url:"/user/"+t,method:"get"})})(t).then(function(t){e.tempUser=t.data,e.findRoles(),e.getQxList(),e.getJdList(e.tempUser.qxid)})},findRoles:function(){var t=this;Object(o.d)().then(function(e){t.roles=e.data})},getList:function(){var t,e=this;this.listLoading=!0,(t=this.query,Object(n.a)({url:"/user/page",method:"POST",data:t})).then(function(t){e.listLoading=!1,e.list=t.data.content,e.$store.dispatch("ToggleTotalCount",t.data.totalElements)})},getQxList:function(){var t=this;l(11).then(function(e){t.qxList=e.data})},getJdList:function(t){var e=this;this.tempUser.jdid="",l(t).then(function(t){e.jdList=t.data})},getIndex:function(t){return(this.$store.getters.pageNum-1)*this.$store.getters.pageRow+t+1},showCreate:function(){this.findRoles(),this.getQxList(),this.tempUser.uuid="",this.tempUser.username="",this.tempUser.password="",this.tempUser.nickname="",this.tempUser.roleId="",this.tempUser.userId="",this.dialogStatus="create",this.dialogFormVisible=!0},showUpdate:function(t){this.getUser(t),this.tempUser.deleteStatus="1",this.dialogStatus="update",this.dialogFormVisible=!0},createUser:function(){var t,e=this;(t=this.tempUser,Object(n.a)({url:"/user",method:"post",data:t})).then(function(){e.getList(),e.dialogFormVisible=!1})},updateUser:function(){var t,e=this,s=this;(t=this.tempUser,Object(n.a)({url:"/user",method:"put",data:t})).then(function(){var t="修改成功";e.dialogFormVisible=!1,e.userId===e.tempUser.userId&&(t="修改成功,部分信息重新登录后生效"),e.$message({message:t,type:"success",duration:1e3,onClose:function(){s.getList()}})})},removeUser:function(t){var e=this;this.$confirm("确定删除此用户?","提示",{confirmButtonText:"确定",showCancelButton:!1,type:"warning"}).then(function(){(function(t){return Object(n.a)({url:"/user/"+t,method:"patch"})})(t).then(function(){e.getList()})})},dateFormat:function(t,e){var s=t[e.property];return void 0===s?"":d()(s).format("YYYY-MM-DD")}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("router-view"),t._v(" "),t.showList?s("div",{staticClass:"filter-container"},[s("el-form",[s("el-form-item",[t.hasPerm("user:add")?s("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.showCreate}},[t._v("添加\n        ")]):t._e()],1)],1)],1):t._e(),t._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:t.list,"element-loading-text":"加载中",border:"",fit:"","highlight-current-row":""}},[s("el-table-column",{attrs:{align:"center",label:"序号",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{domProps:{textContent:t._s(t.getIndex(e.$index))}})]}}])}),t._v(" "),s("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",label:"昵称",prop:"nickname"}}),t._v(" "),s("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",label:"用户名",prop:"username"}}),t._v(" "),s("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",label:"区划",prop:"cityName"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",label:"创建时间",formatter:t.dateFormat,prop:"createDate",width:"170"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",label:"修改时间",formatter:t.dateFormat,prop:"modifyDate",width:"170"}}),t._v(" "),s("el-table-column",{attrs:{align:"center",label:"管理",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.hasPerm("user:update")?s("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:function(s){t.showUpdate(e.row.uuid)}}},[t._v("修改")]):t._e(),t._v(" "),t.hasPerm("user:delete")?s("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(s){t.removeUser(e.row.uuid)}}},[t._v("删除\n        ")]):t._e()]}}])})],1),t._v(" "),s("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[s("el-form",{staticClass:"small-space",staticStyle:{width:"500px","margin-left":"50px"},attrs:{model:t.tempUser,"label-position":"right","label-width":"80px"}},[s("el-input",{attrs:{type:"hidden"},model:{value:t.tempUser.uuid,callback:function(e){t.$set(t.tempUser,"uuid",e)},expression:"tempUser.uuid"}}),t._v(" "),s("el-form-item",{attrs:{label:"用户名",required:""}},[s("el-input",{attrs:{type:"text"},model:{value:t.tempUser.username,callback:function(e){t.$set(t.tempUser,"username",e)},expression:"tempUser.username"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"密码",required:""}},[s("el-input",{attrs:{type:"password"},model:{value:t.tempUser.password,callback:function(e){t.$set(t.tempUser,"password",e)},expression:"tempUser.password"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"角色",required:""}},[s("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:t.tempUser.roleUuids,callback:function(e){t.$set(t.tempUser,"roleUuids",e)},expression:"tempUser.roleUuids"}},t._l(t.roles,function(t){return s("el-option",{key:t.uuid,attrs:{label:t.roleName,value:t.uuid}})}))],1),t._v(" "),s("el-form-item",{attrs:{label:"昵称",required:""}},[s("el-input",{attrs:{type:"text"},model:{value:t.tempUser.nickname,callback:function(e){t.$set(t.tempUser,"nickname",e)},expression:"tempUser.nickname"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"区划",required:""}},[s("el-select",{staticStyle:{width:"49%"},attrs:{placeholder:"请选择"},on:{change:function(e){t.getJdList(t.tempUser.qxid)}},model:{value:t.tempUser.qxid,callback:function(e){t.$set(t.tempUser,"qxid",e)},expression:"tempUser.qxid"}},t._l(t.qxList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),s("el-select",{staticStyle:{width:"49%"},attrs:{placeholder:"请选择"},model:{value:t.tempUser.jdid,callback:function(e){t.$set(t.tempUser,"jdid",e)},expression:"tempUser.jdid"}},t._l(t.jdList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),"create"==t.dialogStatus?s("el-button",{attrs:{type:"success"},on:{click:t.createUser}},[t._v("创 建")]):s("el-button",{attrs:{type:"primary"},on:{click:t.updateUser}},[t._v("修 改")])],1)],1)],1)},staticRenderFns:[]},p=s("VU/8")(c,m,!1,null,null,null);e.default=p.exports},STSY:function(t,e,s){"use strict";e.e=function(t){return Object(i.a)({url:"/roles/page",method:"post",data:t})},e.c=function(t){return Object(i.a)({url:"/roles/"+t,method:"get"})},e.a=function(t){return Object(i.a)({url:"/roles/",method:"post",data:t})},e.f=function(t){return Object(i.a)({url:"/roles/",method:"put",data:t})},e.b=function(t){return Object(i.a)({url:"/roles/"+t,method:"patch"})},e.d=function(){return Object(i.a)({url:"/roles",method:"get"})};var i=s("VsUZ")}});