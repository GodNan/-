webpackJsonp([82],{FaVf:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("Dd8w"),o=i.n(s),a=i("NYxO"),l=i("rLcC"),r=i("M3VY"),n=i("BzqM"),d=i("bBKa"),c=i("q1Tu"),h=i("brym"),u=i("9/5Y"),p=i("iVcN"),f=i("5u+E"),g=i("zHhc"),m=i("UqAJ"),v=i("n4mu"),b=i("CLIt"),k={eye:1,ear:2,speech:3,body:4,iq:5,mental:6},I=["eye","ear","speech","body","iq","mental"],$=["idteye","idtear","idtspeech","idtbody","idtiq","idtmental"],y={components:{Citizen:l.default,Eye:r.default,Ear:n.default,Speech:d.default,IdtBody:c.default,Iq:h.default,Mental:u.default,IdtResult:p.default,TasksLog:f.default,OperLog:g.default,IdtphotoOldShow:m.default,GuardianPhotoUpload:v.default},data:function(){return{dialogVisible:!1,isSubmitting:!1,active:"",shouldLoadIdtKindInfo:!1,valid:!1,requestId:this.$route.params.requestId,checkList:["citizen","resultX"],kindIdtSelected:["resultX","taskslog"],alert:{success:"提交:正常提交评残结果,(类别等级变更的数据,如果需要保留之前的类别,也需要录入对应的评残信息);",reject:"驳回:驳回到之前的流程节点;",noPassed:"不通过:直接结束当前流程."},idt:{min:0,optionsApplyFor:"",dtocitizen:{},dtoeye:{},dtoear:{},dtospeech:{},dtobody:{},dtoiq:{},dtomental:{},dtoresultX:{}}}},created:function(){this.setOptionsApplyFor()},watch:{"kindIdting.kindstr":"setOptionsApplyFor",checkList:function(t){if(console.log("checkList:",t),t.length>3)console.log("val.length > 3"),this.$store.dispatch("ToggleIdtKind",7),this.active=t[t.length-1],this.shouldLoadIdtKindInfo||(this.active="citizen",this.shouldLoadIdtKindInfo=!0);else if(t.length>2){console.log("val.length > 2"),console.log("this.shouldLoadIdtKindInfo:",this.shouldLoadIdtKindInfo);var e=t[2],i=k[e];this.$store.dispatch("ToggleIdtKind",i),this.active=t[t.length-1],this.shouldLoadIdtKindInfo||(this.active="citizen",this.shouldLoadIdtKindInfo=!0)}else console.log("val.length > 2 else"),this.$store.dispatch("ToggleIdtKind",""),this.active="citizen"}},computed:o()({},Object(a.b)(["isHulian","guardianOrAgent","processId"]),{kindIdting:function(){return{kindstr:this.$store.getters.kindstr}},activeName:{get:function(){return""===this.active?this.checkList.length<3?"citizen":this.shouldLoadIdtKindInfo?this.checkList[this.checkList.length-1]:(this.active="citizen",this.shouldLoadIdtKindInfo=!0,"citizen"):this.active},set:function(t){}}}),methods:{reject:function(){var t=this;this.$confirm("即将跳转到流程驳回页面,是否继续?","提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){t.$router.push({name:"tasksTodoApplyHandleIdtReject",params:{cdpfId:t.$route.params.cdpfId,requestId:t.$route.params.requestId,handle:!0}})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},noPassed:function(){var t=this,e=58===this.processId?",类别等级变更前的类别也将取消":"";this.$confirm("不通过后,残疾人当前鉴定流程将会结束"+e+",是否继续?","提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){t.$router.push({name:"tasksTodoApplyHandleIdtNoPassed",params:{cdpfId:t.$route.params.cdpfId,requestId:t.$route.params.requestId}})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},getGuardianPhoto:function(){this.$store.dispatch("ToggleShowGuardianPhoto",1)},guardianPhotoShow:function(){this.dialogVisible=!0},handleClick:function(t,e){console.log("handleClick tab:",t);var i=this.$refs["idt"+t.name].loaded,s=this.has(this.kindIdtSelected,t.name);console.log("loaded:",i),console.log("shuoldLoaded:",s),!i&&s&&(console.log("handleClick getIdtInfo"),this.$refs["idt"+t.name].getIdtInfo()),"operlog"===t.name&&this.$refs.idtoperlog.getIdtInfo(),"photoOldShow"===t.name&&(console.log("idt handleClick idtphotoOldShow:",t.name),this.$refs.idtphotoOldShow.getIdtInfo()),this.active=t.name},validateIdt:function(){var t=this;this.isSubmitting=!0;for(var e=function(e){var i=t.checkList[e];if(console.log("tab:",i),console.log('this.$refs["idt" + tab].$refs[tab]',t.$refs["idt"+i].$refs[i]),t.$refs["idt"+i].$refs[i].validate(function(e){e&&(console.log("idt",i),t.idt["dto"+i]=t.$refs["idt"+i][i]),t.valid=e}),!t.valid)return t.isSubmitting=!1,t.handleClick({name:i}),"break";t.active="citizen"},i=this.checkList.length-1;i>-1;i--){if("break"===e(i))break}},validateIdtPhoto:function(){for(var t=!0,e=this.checkList.length-1;e>-1;e--){var i=this.checkList[e];if("citizen"!==i&&"resultX"!==i){var s=this.$refs["idt"+i].$refs.idtPhoto.imageUrl,o=this.$refs["idt"+i].$refs.idtPhoto.oldIdtPhoto;if(""===s&&!o){t=!1,this.handleClick({name:i}),alert("请上传评残图片");break}}}return t},saveIdtMin:function(){var t=this;if(this.isSubmitting=!0,this.validateIdtPhoto()){if(this.validateIdt(),!this.valid)return!1;this.idt.min=1,this.idt.optionsApplyFor="",this.getOptionsApplyFor(),Object(b.c)(this.idt).then(function(e){t.isSubmitting=!1,alert(e.content)})}else this.isSubmitting=!1},saveIdt:function(){var t=this;if(this.validateIdtPhoto()){if(this.validateIdt(),!this.valid)return!1;this.idt.min=0,this.idt.optionsApplyFor="",console.log("saveIdt:"),console.log("this.idt.dtocitizen",this.idt.dtocitizen),console.log("this.idt.dtocitizen.requestId",this.idt.dtocitizen.requestId),this.getOptionsApplyFor(),Object(b.c)(this.idt).then(function(e){console.log("updateIdt:"),t.isSubmitting=!1,alert(e.content),t.$router.push({name:"tasksTodoList"})})}},getOptionsApplyFor:function(){console.log("getOptionsApplyFor:");var t="";if(this.checkList.length>2){this.checkList.forEach(function(e){var i=k[e];""!==i&&void 0!==i&&t.indexOf(i)<0&&(t+=i+",")});var e=t.substr(0,t.length-1).split(","),i="",s="";if(console.log("temps:",e),e.length>0)for(var o=e.sort(),a=0;a<o.length;a++){var l=o[a];if(i.indexOf(l)<0){i+=l+",";var r=$[l-1],n=I[l-1];s+=l+","+this.$refs[r][n][n+"Level"]+","}}this.idt.optionsApplyFor=i,this.$refs.idtresultX.resultX.kindstr=i,this.$refs.idtresultX.resultX.levelstr=s,console.log("this.$refs['idtresultX']['resultX']['kindstr']:",this.$refs.idtresultX.resultX.kindstr),console.log("this.$refs['idtresultX']['resultX']['levelstr']",this.$refs.idtresultX.resultX.levelstr)}},setOptionsApplyFor:function(){var t=this;console.log("setOptionsApplyFor"),console.log("this.$store.getters.kindstr:",this.$store.getters.kindstr),console.log("this.$store.getters.oldKindstr:",this.$store.getters.oldKindstr);for(var e="",i=this.$store.getters.kindstr.split(","),s=0;s<i.length;s++){var o=i[s];e.indexOf(o)<0&&(e+=o+",")}null!==e&&""!==e&&e.split(",").forEach(function(e){""!==e&&void 0!==e&&-1===t.checkList.indexOf(I[e-1])&&(t.checkList.push(I[e-1]),t.kindIdtSelected.push(I[e-1]))})}}},_={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-form",{attrs:{size:"medium"}},[i("el-row",[i("el-col",{attrs:{span:15}},[i("el-form-item",{attrs:{label:"残疾类别:"}},[i("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[i("el-checkbox",{attrs:{label:"eye",border:""}},[t._v("视力")]),t._v(" "),i("el-checkbox",{attrs:{label:"ear",border:""}},[t._v("听力")]),t._v(" "),i("el-checkbox",{attrs:{label:"speech",border:""}},[t._v("言语")]),t._v(" "),i("el-checkbox",{attrs:{label:"body",border:""}},[t._v("肢体")]),t._v(" "),i("el-checkbox",{attrs:{label:"iq",border:""}},[t._v("智力")]),t._v(" "),i("el-checkbox",{attrs:{label:"mental",border:""}},[t._v("精神")])],1)],1)],1),t._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",[2===t.guardianOrAgent?i("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(e){t.guardianPhotoShow()}}},[t._v("监护人证明")]):t._e()],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:5}},[i("el-alert",{attrs:{title:t.alert.success,type:"success",closable:!1}})],1),t._v(" "),i("el-col",{attrs:{span:5}},[i("el-alert",{attrs:{title:t.alert.reject,type:"warning",closable:!1}})],1),t._v(" "),i("el-col",{attrs:{span:5}},[i("el-alert",{attrs:{title:t.alert.noPassed,type:"error",closable:!1}})],1),t._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",[t.isSubmitting?t._e():i("el-button",{attrs:{type:"primary",icon:"el-icon-success"},on:{click:t.saveIdt}},[t._v("提交")])],1)],1),t._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",[i("el-button",{attrs:{type:"warning",icon:"el-icon-back"},on:{click:function(e){t.reject()}}},[t._v("驳回")])],1)],1),t._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",[i("el-button",{attrs:{type:"danger",icon:"el-icon-error"},on:{click:function(e){t.noPassed()}}},[t._v("不通过")])],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.isSubmitting,expression:"isSubmitting",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"操作处理中"}})],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"监护人证明",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},opened:t.getGuardianPhoto}},[i("guardian-photo-upload",{ref:"guardianPhoto",attrs:{mark:this.$route.params.cdpfId,photoEdit:""}})],1),t._v(" "),i("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"citizen"}},[i("citizen",{ref:"idtcitizen",attrs:{idt:"",mark:this.$route.params.cdpfId}})],1),t._v(" "),t.has(t.checkList,"eye")?i("el-tab-pane",{attrs:{label:"视力残疾",name:"eye"}},[i("eye",{ref:"idteye",attrs:{mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.has(t.checkList,"ear")?i("el-tab-pane",{attrs:{label:"听力残疾",name:"ear"}},[i("ear",{ref:"idtear",attrs:{mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.has(t.checkList,"speech")?i("el-tab-pane",{attrs:{label:"言语残疾",name:"speech"}},[i("speech",{ref:"idtspeech",attrs:{mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.has(t.checkList,"body")?i("el-tab-pane",{attrs:{label:"肢体残疾",name:"body"}},[i("idt-body",{ref:"idtbody",attrs:{mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.has(t.checkList,"iq")?i("el-tab-pane",{attrs:{label:"智力残疾",name:"iq"}},[i("iq",{ref:"idtiq",attrs:{mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.has(t.checkList,"mental")?i("el-tab-pane",{attrs:{label:"精神残疾",name:"mental"}},[i("mental",{ref:"idtmental",attrs:{mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),i("el-tab-pane",{attrs:{label:"评定结果",name:"resultX"}},[i("idt-result",{ref:"idtresultX",attrs:{mark:this.$route.params.requestId}})],1),t._v(" "),i("el-tab-pane",{attrs:{label:"旧系统评残照片",name:"photoOldShow"}},[i("idtphoto-old-show",{ref:"idtphotoOldShow"})],1),t._v(" "),i("el-tab-pane",{attrs:{label:"任务历史",name:"taskslog"}},[i("tasks-log",{ref:"idttaskslog",attrs:{mark:this.$route.params.requestId}})],1),t._v(" "),i("el-tab-pane",{attrs:{label:"操作历史",name:"operlog"}},[i("oper-log",{ref:"idtoperlog",attrs:{mark:this.$route.params.cdpfId}})],1)],1)],1)},staticRenderFns:[]},L=i("VU/8")(y,_,!1,null,null,null);e.default=L.exports}});