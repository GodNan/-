webpackJsonp([64],{vmUi:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("Dd8w"),i=s.n(o),a=s("NYxO"),r=s("rLcC"),n=s("M3VY"),l=s("BzqM"),d=s("bBKa"),u=s("q1Tu"),h=s("brym"),c=s("9/5Y"),p=s("iVcN"),f=s("5u+E"),m=s("zHhc"),g=s("n4mu"),b=s("UqAJ"),v=s("v6sq"),S=s("jSlZ"),k=s("Q3je"),q=s("Vge3"),y=s("7qrd"),I=s("zL8q"),_=["eye","ear","speech","body","iq","mental"],N=["视力","听力","言语","肢体","智力","精神"],$={components:{Citizen:r.default,Eye:n.default,Ear:l.default,Speech:d.default,IdtBody:u.default,Iq:h.default,Mental:c.default,IdtResult:p.default,TasksLog:f.default,GuardianPhotoUpload:g.default,OperLog:m.default,IdtphotoOldShow:b.default,LogoutPhotoUpload:y.default,CardPhotoUpload:v.default},data:function(){var t=this;return{photoEdit:!0,isLoading:!1,isSubmitting:!1,dialogVisible:!1,dialogVisibleZhuxiao:!1,cardPhotoVisible:!1,kindIdtSelected:["resultX","taskslog"],activeStep:0,activeName:"citizen",steps:[],backSteps:[],logout:{logoutReason:""},logoutRules:{logoutReason:[{required:!0,message:"请选择注销原因",trigger:"change"}]},requestNote:{requestId:this.$route.params.requestId,userId:this.$store.getters.userId,userName:this.$store.getters.nickname,note:"",handleState:this.$store.getters.handleState,finishState:0,handleType:"",backState:"",idtAtHome:2},requestStakeholder:{requestId:this.$route.params.requestId,userId:"",cityid:this.$store.getters.cityid+"%",permissionId:"",delFlag:0},dtoState:{processId:this.$store.getters.processId,stateType:3,stateCode:0},rules:{handleType:[{required:!0,message:"请选择处理结果",trigger:"change"}],backState:[{validator:function(e,s,o){2===t.requestNote.handleType&&""===s&&o(new Error("请选择回退节点!")),o()},trigger:"change"}],note:[{validator:function(e,s,o){""!==t.requestNote.handleType&&1!==t.requestNote.handleType&&""===s&&o(new Error("请填写处理意见!")),o()},trigger:"blur"}],idtAtHome:[{required:!0,message:"请选择是否入户评残",trigger:"change"}]}}},computed:i()({},Object(a.b)(["kindstr","guardianOrAgent","isGongan","dict","isHulian","processId","citizenId"]),{gonganAlert:function(){return 0===this.isGongan||null===this.isGongan||void 0===this.isGongan?"公安部未验证":1===this.isGongan?"公安部已验证":2===this.isGongan?"公安部验证姓名身份证号不一致,需要残疾人在互联网(北京市残疾人网上服务平台)修改姓名":"公安部查无此人,需要残疾人在互联网重新注册"},idtAtHomeShouldShow:function(){return!(119!==this.requestNote.handleState&&209!==this.requestNote.handleState||18!==this.dtoState.processId&&19!==this.dtoState.processId&&58!==this.dtoState.processId&&59!==this.dtoState.processId)},isZw:function(){return 119!==this.requestNote.handleState&&209!==this.requestNote.handleState&&217!==this.requestNote.handleState&&218!==this.requestNote.handleState&&99!==this.requestNote.handleState},couldPass:function(){return 217!==this.requestNote.handleState},couldReturn:function(){return 119!==this.requestNote.handleState&&217!==this.requestNote.handleState},processName:function(){var t=this;return this.dict.processList.filter(function(e){return parseInt(e.code,10)===t.$store.getters.processId})[0].description+" :"},kindstrApply:function(){var t=this.$store.getters.kindstr;if(""===t||null===t||void 0===t)return"";if(t.indexOf(",")<0)return"";for(var e=t.split(","),s="",o=0;o<e.length;o++)","!==e[o]&&""!==e[o]&&(s+=N[parseInt(e[o],10)-1]+" ");return s}}),watch:{steps:function(t){var e=this;"tasksTodoHandle"!==this.$route.name&&"tasksAllTaskCancleHandle"!==this.$route.name||t.length>0&&(this.activeStep=this.steps.find(function(t){return t.stateCode===e.$store.getters.handleState}).orderNum-1,this.getBackSteps())},"requestNote.handleType":function(t){var e=this;1===t?(this.requestStakeholder.delFlag=0,this.activeStep===this.steps.length-1?(this.requestNote.finishState=this.requestNote.handleState,this.requestStakeholder.delFlag=1,this.requestStakeholder.permissionId="nonebdpfnew"):(this.requestStakeholder.delFlag=0,this.requestNote.finishState=this.steps.find(function(t){return t.orderNum===e.activeStep+2}).stateCode,this.requestStakeholder.permissionId=this.steps.find(function(t){return t.stateCode===e.requestNote.finishState}).permissionId)):3===t?(this.requestNote.finishState=99,this.requestStakeholder.delFlag=1,this.requestStakeholder.permissionId="nonebdpfnew"):this.requestStakeholder.delFlag=0},"requestNote.backState":function(t){var e=this;""!==t&&(this.requestNote.finishState=t,this.requestStakeholder.permissionId=this.steps.find(function(t){return t.stateCode===e.requestNote.finishState}).permissionId)},"requestNote.idtAtHome":function(t){var e=this;1===t&&this.$confirm('入户评残选择 "是"：受理后无需预约医院,直接填写评定表,必须线下沟通,经区残联同意才可入户评残,不可随意选择,确定选"是"吗？',"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){}).catch(function(){e.$message({type:"info",message:"已取消操作"}),e.requestNote.idtAtHome=2})}},created:function(){this.getSteps(),this.setOptionsApplyFor(),this.getDict("d_logout_reason","logoutReasonList")},methods:{logoutPhotoUpload:function(){this.photoEdit=!0,this.dialogVisibleZhuxiao=!0},guardianPhotoUpload:function(){this.photoEdit=!0,this.dialogVisible=!0},logoutPhotoShow:function(){this.photoEdit=!1,this.dialogVisibleZhuxiao=!0},guardianPhotoShow:function(){this.photoEdit=!1,this.dialogVisible=!0},getGuardianPhoto:function(){this.$store.dispatch("ToggleShowGuardianPhoto",1)},apply:function(){var t=this,e={cdpfId:this.$route.params.cdpfId,processId:this.$store.getters.processCode[this.$route.name],logoutReason:this.logoutReason};Object(k.d)(e).then(function(e){t.$router.push({name:"tasksTodoList"})})},submit:function(){var t=this;1===this.requestNote.idtAtHome?this.$confirm('入户评残选择 "是"：受理后无需预约医院,直接填写评定表,必须线下沟通,经区残联同意才可入户评残,不可随意选择,确定选"是"吗？)',"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){t.isSubmitting=!0,t.$refs.handle.validate(function(e){if(!e)return t.isSubmitting=!1,!1;t.handleHandleType()})}).catch(function(){t.$message({type:"info",message:"已取消操作"})}):(this.isSubmitting=!0,this.$refs.handle.validate(function(e){if(!e)return t.isSubmitting=!1,!1;t.handleHandleType()}))},handleHandleType:function(){3===this.requestNote.handleType?this.handleHandleTypeThree():1===this.requestNote.handleType?this.handleHandleTypeOne():this.handleBusiness()},handleHandleTypeOne:function(){var t=this;this.hasHlWorkFlow(this.$store.getters.processId)&&2===this.guardianOrAgent?Object(q.k)(this.$route.params.cdpfId).then(function(e){return"success"!==e.type?(t.isSubmitting=!1,void t.$message.error("监护人证明图片数量验证失败,请稍后再试")):e.data<1?(t.isSubmitting=!1,void t.$message.error("请上传监护人证明图片")):void t.handleBusiness()}):this.handleBusiness()},handleHandleTypeThree:function(){var t=this;this.$confirm('选择"不通过"这个流程将会结束,是否确定操作?',"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){t.handleBusiness()}).catch(function(){return t.$message({type:"info",message:"已取消操作"}),t.isSubmitting=!1,!1})},handleBusiness:function(){var t=this;1===this.requestNote.idtAtHome&&1===this.requestNote.handleType&&209===this.requestNote.handleState&&(this.requestNote.finishState=219,this.requestStakeholder.permissionId="idtinfoInput",this.requestNote.note="入户评残：受理后直接填写评定表");var e={requestNote:this.requestNote,requestStakeholder:this.requestStakeholder,processId:this.$store.getters.processId};Object(k.b)(e).then(function(e){"success"===e.type?"tasksTodoHandle"===t.$route.name?t.$router.push({name:"tasksTodoList"}):t.$router.push({name:"tasksAllList"}):(t.isSubmitting=!1,Object(I.Message)({message:e.content,type:"error",duration:4e3}))})},handleClick:function(t,e){var s=this.$refs["idt"+t.name].loaded,o=this.has(this.kindIdtSelected,t.name);!s&&o&&this.$refs["idt"+t.name].getIdtInfo(),"operlog"===t.name&&this.$refs.idtoperlog.getIdtInfo(),"photoOldShow"===t.name&&this.$refs.idtphotoOldShow.getIdtInfo()},getSteps:function(){var t=this;this.isLoading=!0,this.dtoState.stateType=3,Object(S.c)(this.dtoState).then(function(e){t.isLoading=!1,t.steps=e.data.sort(function(t,e){return t.orderNum-e.orderNum})})},getBackSteps:function(){var t=this;this.dtoState.stateType=1,this.dtoState.orderNum=this.activeStep+1,Object(S.a)(this.dtoState).then(function(e){t.backSteps=e.data.filter(function(t){return t.orderNum>1});var s=t.requestNote.handleState,o=t.$store.getters.processId;t.isCanlianInputing(o)?25===s?t.backSteps=t.backSteps.filter(function(t){return 219===t.stateCode}):30===s&&(t.backSteps=t.backSteps.filter(function(t){return 219===t.stateCode||25===t.stateCode})):t.isHospitalInputing(o)&&30===s&&(t.backSteps=t.backSteps.filter(function(t){return 25===t.stateCode}))})},setOptionsApplyFor:function(){var t=this,e=this.$store.getters.kindstr;null!==e&&""!==e&&(e.split(",").forEach(function(e){""!==e&&void 0!==e&&t.kindIdtSelected.push(_[e-1])}),this.active="citizen")},cardPhotoUp:function(){this.cardPhotoVisible=!0},handleCardClose:function(t){this.$refs.idtcitizen.getCitizenPhotoNow(this.citizenId),t()}}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[this.$route.params.handle&&1===t.isGongan?s("el-card",["tasksTodoHandle"===this.$route.name||"tasksAllTaskCancleHandle"===this.$route.name?s("el-form",{directives:[{name:"loading",rawName:"v-loading.body",value:t.isLoading,expression:"isLoading",modifiers:{body:!0}}],ref:"handle",attrs:{model:t.requestNote,rules:t.rules,size:"medium","label-position":"left","label-width":"85px","element-loading-text":"加载中"}},[s("el-row",[s("el-col",[s("el-form-item",{attrs:{label:t.processName,"label-width":"170px"}},[s("el-steps",{attrs:{active:t.activeStep}},t._l(t.steps,function(t){return s("el-step",{key:t.stateCode,attrs:{title:t.name,icon:t.icon}})}))],1)],1)],1),t._v(" "),t.idtAtHomeShouldShow?s("el-row",[s("el-col",{attrs:{span:7}},[s("el-form-item",{attrs:{label:"是否入户评残:",prop:"idtAtHome","label-width":"110px"}},[s("el-radio-group",{model:{value:t.requestNote.idtAtHome,callback:function(e){t.$set(t.requestNote,"idtAtHome",e)},expression:"requestNote.idtAtHome"}},[s("el-radio",{attrs:{label:1}},[t._v("是")]),t._v(" "),s("el-radio",{attrs:{label:2}},[t._v("否")])],1)],1)],1),t._v(" "),s("el-col",{attrs:{span:17}},[s("el-form-item",[s("span",{staticStyle:{color:"red"}},[t._v("入户评残：受理后无需预约医院,直接填写评定表(必须线下沟通,经区残联同意才可入户评残,不可随意选择.)")])])],1)],1):t._e(),t._v(" "),s("el-row",[s("el-col",{attrs:{span:9}},[s("el-form-item",{attrs:{label:"处理结果:",prop:"handleType"}},[s("el-radio-group",{model:{value:t.requestNote.handleType,callback:function(e){t.$set(t.requestNote,"handleType",e)},expression:"requestNote.handleType"}},[t.couldPass?s("el-radio",{attrs:{label:1}},[t._v("通过")]):t._e(),t._v(" "),s("el-radio",{attrs:{label:3}},[t._v("不通过(结束)")]),t._v(" "),t.couldReturn?s("el-radio",{attrs:{label:2}},[t._v("驳回")]):t._e()],1)],1)],1),t._v(" "),2===t.requestNote.handleType?s("el-col",{attrs:{span:4}},[s("el-form-item",{attrs:{"label-width":"2px",prop:"backState"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.requestNote.backState,callback:function(e){t.$set(t.requestNote,"backState",e)},expression:"requestNote.backState"}},t._l(t.backSteps,function(t){return s("el-option",{key:t.stateCode,attrs:{label:t.name,value:t.stateCode}})}))],1)],1):t._e()],1),t._v(" "),s("el-row",{attrs:{gutter:15}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"处理意见:",prop:"note"}},[s("el-input",{attrs:{type:"textarea"},model:{value:t.requestNote.note,callback:function(e){t.$set(t.requestNote,"note",e)},expression:"requestNote.note"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{label:"申请类别:"}},[s("el-alert",{attrs:{title:t.kindstrApply,type:"error",closable:!1}})],1)],1),t._v(" "),s("el-col",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.isSubmitting,expression:"isSubmitting",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"操作处理中"}})],1),t._v(" "),s("el-row",[s("el-col",[s("el-form-item",{attrs:{"label-width":"0"}},[t.isSubmitting?t._e():s("el-button",{attrs:{type:"primary",icon:"el-icon-success"},on:{click:t.submit}},[t._v("提交")]),t._v(" "),2===t.guardianOrAgent?s("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(e){t.guardianPhotoUpload()}}},[t._v("监护人证明图片")]):t._e(),t._v(" "),4===t.processId?s("el-button",{attrs:{type:"",icon:"el-icon-refresh"},on:{click:function(e){t.logoutPhotoUpload()}}},[t._v("注销证明图片")]):t._e(),t._v(" "),18===t.processId||19===t.processId||1409===t.processId||1209===t.processId?s("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(e){t.cardPhotoUp()}}},[t._v("卡面照片上传")]):t._e()],1)],1)],1)],1):"logoutApplyHandle"==this.$route.name?s("el-form",{attrs:{model:t.logout,rules:t.logoutRules}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"注销原因:",prop:"logoutReason"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.logout.logoutReason,callback:function(e){t.$set(t.logout,"logoutReason",e)},expression:"logout.logoutReason"}},t._l(t.dict.logoutReasonList,function(t){return s("el-option",{key:t.id,attrs:{label:t.description,value:t.id}})}))],1)],1)],1),t._v(" "),s("el-row",[s("el-col",[s("el-form-item",{attrs:{"label-width":"0"}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-success"},on:{click:t.apply}},[t._v("提交")])],1)],1)],1)],1):s("el-form",{attrs:{size:"medium","label-position":"left","label-width":"85px"}},[s("el-row",[s("el-col",[s("el-form-item",{attrs:{"label-width":"0"}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-success"},on:{click:t.apply}},[t._v("提交")])],1)],1)],1)],1)],1):s("el-card",[this.$route.name.indexOf("Info")?s("el-alert",{attrs:{title:t.gonganAlert,type:"error",closable:!1}}):t._e(),t._v(" "),2===t.guardianOrAgent?s("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(e){t.guardianPhotoShow()}}},[t._v("监护人证明图片")]):t._e(),t._v(" "),4===t.processId||49===t.processId?s("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(e){t.logoutPhotoShow()}}},[t._v("注销证明图片")]):t._e(),t._v(" "),18===t.processId||19===t.processId||1409===t.processId||1209===t.processId?s("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(e){t.cardPhotoUp()}}},[t._v("卡面照片上传")]):t._e()],1),t._v(" "),s("el-dialog",{attrs:{title:"卡面照片上传",visible:t.cardPhotoVisible,"before-close":t.handleCardClose},on:{"update:visible":function(e){t.cardPhotoVisible=e}}},[s("card-photo-upload",{ref:"cardPhoto",attrs:{mark:t.citizenId}})],1),t._v(" "),s("el-dialog",{attrs:{title:"监护人证明",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},opened:t.getGuardianPhoto}},[s("guardian-photo-upload",{ref:"guardianPhoto",attrs:{photoEdit:t.photoEdit,mark:this.$route.params.cdpfId}})],1),t._v(" "),s("el-dialog",{attrs:{title:"注销证明",visible:t.dialogVisibleZhuxiao},on:{"update:visible":function(e){t.dialogVisibleZhuxiao=e}}},[s("logout-photo-upload",{ref:"logoutPhoto",attrs:{photoEdit:t.photoEdit,mark:this.$route.params.cdpfId}})],1),t._v(" "),s("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"基本信息",name:"citizen"}},[s("citizen",{ref:"idtcitizen",attrs:{idt:"",info:"",mark:this.$route.params.cdpfId}})],1),t._v(" "),t.isZw&&t.has(t.kindstr,"1")?s("el-tab-pane",{attrs:{label:"视力残疾",name:"eye"}},[s("eye",{ref:"idteye",attrs:{info:"",mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.isZw&&t.has(t.kindstr,"2")?s("el-tab-pane",{attrs:{label:"听力残疾",name:"ear"}},[s("ear",{ref:"idtear",attrs:{info:"",mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.isZw&&t.has(t.kindstr,"3")?s("el-tab-pane",{attrs:{label:"言语残疾",name:"speech"}},[s("speech",{ref:"idtspeech",attrs:{info:"",mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.isZw&&t.has(t.kindstr,"4")?s("el-tab-pane",{attrs:{label:"肢体残疾",name:"body"}},[s("idt-body",{ref:"idtbody",attrs:{info:"",mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.isZw&&t.has(t.kindstr,"5")?s("el-tab-pane",{attrs:{label:"智力残疾",name:"iq"}},[s("iq",{ref:"idtiq",attrs:{info:"",mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.isZw&&t.has(t.kindstr,"6")?s("el-tab-pane",{attrs:{label:"精神残疾",name:"mental"}},[s("mental",{ref:"idtmental",attrs:{info:"",mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),t.isZw&&t.has(t.kindstr,",")?s("el-tab-pane",{attrs:{label:"评定结果",name:"resultX"}},[s("idt-result",{ref:"idtresultX",attrs:{info:"",mark:this.$route.params.requestId}})],1):t._e(),t._v(" "),1!==t.isHulian?s("el-tab-pane",{attrs:{label:"旧系统评残照片",name:"photoOldShow"}},[s("idtphoto-old-show",{ref:"idtphotoOldShow"})],1):t._e(),t._v(" "),s("el-tab-pane",{attrs:{label:"任务历史",name:"taskslog"}},[s("tasks-log",{ref:"idttaskslog",attrs:{mark:this.$route.params.requestId}})],1),t._v(" "),s("el-tab-pane",{attrs:{label:"操作历史",name:"operlog"}},[s("oper-log",{ref:"idtoperlog",attrs:{mark:this.$route.params.cdpfId}})],1)],1)],1)},staticRenderFns:[]},T=s("VU/8")($,w,!1,null,null,null);e.default=T.exports}});